class PickupAvailability extends HTMLElement{constructor(){super();!this.hasAttribute("available")||(this.errorHtml=this.querySelector("template").content.firstElementChild.cloneNode(!0),this.onClickRefreshList=this.onClickRefreshList.bind(this),this.fetchAvailability(this.dataset.variantId))}fetchAvailability(e){const t=`${this.dataset.baseUrl}variants/${e}/?section_id=pickup-availability`;fetch(t).then(i=>i.text()).then(i=>{const s=new DOMParser().parseFromString(i,"text/html").querySelector(".shopify-section");this.renderPreview(s)}).catch(i=>{this.querySelector("button")?.removeEventListener("click",this.onClickRefreshList),this.renderError()})}onClickRefreshList(e){this.fetchAvailability(this.dataset.variantId)}renderError(){this.innerHTML="",this.appendChild(this.errorHtml),this.querySelector("button").addEventListener("click",this.onClickRefreshList)}renderPreview(e){const t=document.querySelector("pickup-availability-drawer");if(t&&t.remove(),!e.querySelector("pickup-availability-preview")){this.innerHTML="",this.removeAttribute("available");return}this.innerHTML=e.querySelector("pickup-availability-preview").outerHTML,this.setAttribute("available",""),document.body.appendChild(e.querySelector("pickup-availability-drawer")),this.querySelector("button").addEventListener("click",i=>{document.querySelector("pickup-availability-drawer").show(i.target)})}}customElements.define("pickup-availability",PickupAvailability);class PickupAvailabilityDrawer extends HTMLElement{constructor(){super();this.onBodyClick=this.handleBodyClick.bind(this),this.querySelector("button").addEventListener("click",()=>{this.hide()}),this.addEventListener("keyup",()=>{event.code.toUpperCase()==="ESCAPE"&&this.hide()})}handleBodyClick(e){const t=e.target;t!=this&&!t.closest("pickup-availability-drawer")&&t.id!="ShowPickupAvailabilityDrawer"&&this.hide()}hide(){this.removeAttribute("open"),document.body.removeEventListener("click",this.onBodyClick),document.body.classList.remove("overflow-hidden"),removeTrapFocus(this.focusElement)}show(e){this.focusElement=e,this.setAttribute("open",""),document.body.addEventListener("click",this.onBodyClick),document.body.classList.add("overflow-hidden"),trapFocus(this)}}customElements.define("pickup-availability-drawer",PickupAvailabilityDrawer);
//# sourceMappingURL=/s/files/1/0086/0251/7559/t/4/assets/pickup-availability.js.map?v=3384203228552125197
