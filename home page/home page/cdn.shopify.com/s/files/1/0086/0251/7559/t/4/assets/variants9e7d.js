class VariantSelects extends HTMLElement{constructor(){super();this.addEventListener("change",this.onVariantChange)}onVariantChange(){this.updateOptions(),this.updateMasterId(),this.toggleAddButton(!0,"",!1),this.updatePickupAvailability(),this.currentVariant?(this.updateMedia(),this.updateURL(),this.updateVariantInput(),this.renderProductInfo(),this.doIshiTasks()):(this.toggleAddButton(!0,"",!0),this.setUnavailable())}updateOptions(){this.options=Array.from(this.querySelectorAll("select"),t=>t.value)}updateMasterId(){this.currentVariant=this.getVariantData().find(t=>!t.options.map((i,e)=>this.options[e]===i).includes(!1))}updateMedia(){if(!this.currentVariant||!this.currentVariant?.featured_media)return;const t=document.querySelector(`[data-media-id="${this.dataset.section}-${this.currentVariant.featured_media.id}"]`);!t||(document.getElementById("main-media-container").innerHTML="",document.getElementById("main-media-container").prepend(t.cloneNode(!0)))}updateURL(){!this.currentVariant||window.history.replaceState({},"",`${this.dataset.url}?variant=${this.currentVariant.id}`)}updateVariantInput(){document.querySelectorAll(`#product-form-${this.dataset.section}, #product-form-installment`).forEach(i=>{const e=i.querySelector('input[name="id"]');e.value=this.currentVariant.id,e.dispatchEvent(new Event("change",{bubbles:!0}))})}updatePickupAvailability(){const t=document.querySelector("pickup-availability");!t||(this.currentVariant?.available?t.fetchAvailability(this.currentVariant.id):(t.removeAttribute("available"),t.innerHTML=""))}renderProductInfo(){fetch(`${this.dataset.url}?variant=${this.currentVariant.id}&section_id=${this.dataset.section}`).then(t=>t.text()).then(t=>{const i=`price-${this.dataset.section}`,e=new DOMParser().parseFromString(t,"text/html"),a=document.getElementById(i),r=e.getElementById(i);r&&a&&(a.innerHTML=r.innerHTML),document.getElementById(`price-${this.dataset.section}`)?.classList.remove("visibility-hidden"),this.toggleAddButton(!this.currentVariant.available,window.variantStrings.soldOut)})}toggleAddButton(t=!0,i,e=!0){const a=document.getElementById(`product-form-${this.dataset.section}`)?.querySelector('[name="add"]');!a||(t?(a.setAttribute("disabled",!0),i&&(a.textContent=i)):(a.removeAttribute("disabled"),a.textContent=window.variantStrings.addToCart),!!e)}setUnavailable(){const t=document.getElementById(`product-form-${this.dataset.section}`)?.querySelector('[name="add"]');!t||(t.textContent=window.variantStrings.unavailable,document.getElementById(`price-${this.dataset.section}`)?.classList.add("visibility-hidden"))}getVariantData(){return this.variantData=this.variantData||JSON.parse(this.querySelector('[type="application/json"]').textContent),this.variantData}doIshiTasks(){var t=this.currentVariant,i=document.querySelector(".variant-sku");if(typeof i!="undefined"&&i!=null&&(document.querySelector(".variant-sku").innerHTML=t.sku),document.getElementsByClassName("ishi-progress-content").length){var e=0,a=document.getElementById("variant-"+t.id);typeof a!="undefined"&&a!=null&&(e=parseInt(a.getAttribute("data-stock")));var r=parseInt(document.getElementsByClassName("ishi-progress-content")[0].getAttribute("data-quantity"));if(document.getElementById("variant-stock").innerHTML=e,e>0&&e<=r){document.getElementsByClassName("ishi-progress-content")[0].classList.remove("hidden");var n=document.getElementById("ishi-progress-bar").getElementsByTagName("span")[0];switch(e){case 9:n.style.width="65%";break;case 8:n.style.width="60%";break;case 7:n.style.width="55%";break;case 6:n.style.width="50%";break;case 5:n.style.width="45%";break;case 4:n.style.width="30%";break;case 3:n.style.width="20%";break;case 2:n.style.width="10%";break;case 1:n.style.width="5%";break;default:n.style.width="90%"}}else document.getElementsByClassName("ishi-progress-content")[0].classList.add("hidden")}}}customElements.define("variant-selects",VariantSelects);class VariantRadios extends VariantSelects{constructor(){super()}updateOptions(){const t=Array.from(this.querySelectorAll("fieldset"));this.options=t.map(i=>Array.from(i.querySelectorAll("input")).find(e=>e.checked).value)}}customElements.define("variant-radios",VariantRadios);
//# sourceMappingURL=/s/files/1/0086/0251/7559/t/4/assets/variants.js.map?v=2132837054811032715
